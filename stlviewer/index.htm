<!doctype html>

<head>
    <style type="text/css">
       div.stlviewer { height: 500px; }
    </style>
    <script type=text/javascript> 
	// window.onload=function() {
	// 	STLViewerEnable("stlviewer");
	//  } 
    </script>
    <script src="/three.js/build/three.min.js"></script>
    <script src="/three.js/examples/js/WebGL.js"></script>
    <script src="/three.js/examples/js/loaders/STLLoader.js"></script>
    <script src="/three.js/examples/js/controls/OrbitControls.js"></script>
    <script src="/stlviewer.js"></script>
    <title>A Simple STL Viewer with Three.js</title>
</head>

<body>
    <div id="stlviewer" class="stlviewer"></div>
    

    <script>
        window.addEventListener("message", (event) => {
            if (event.origin !== "http://127.0.0.1:5500") return; // Ensure only trusted messages are processed
            
            if (event.data.action === "set3DView") {
                let viewer = document.getElementById("stlviewer");
                viewer.setAttribute("data-src", event.data.src);
                STLViewerEnable("stlviewer"); // Ensure this function is available
            }
        });
    </script>
</body>